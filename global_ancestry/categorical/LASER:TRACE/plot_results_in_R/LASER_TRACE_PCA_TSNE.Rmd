---
title: "Global Ancestry via LASER/TRACE -- TSNE & PCA"
output: html_notebook
---

Set up
```{r}
library(plotly)
library(dbplyr)
library(plyr)
library(stringi)
library(Rtsne)
library(gridExtra)  
library(ggplot2)
library(reshape2)
library(data.table)
library(tidyverse)
#work_dir <- "/Users/mpostel/Desktop"
#setwd(work_dir)
```

Read in
```{r}
sample_coord1 <- read.table(file = 'results.1-1250.ProPC.coord', sep = '\t', header = TRUE)
sample_coord2 <- read.table(file = 'results.1251-2500.ProPC.coord', sep = '\t', header = TRUE)
sample_coord3 <- read.table(file = 'results.2501-3750.ProPC.coord', sep = '\t', header = TRUE)
sample_coord4 <- read.table(file = 'results.3751-5000.ProPC.coord', sep = '\t', header = TRUE)
sample_coord5 <- read.table(file = 'results.5001-6250.ProPC.coord', sep = '\t', header = TRUE)
sample_coord6 <- read.table(file = 'results.6251-7500.ProPC.coord', sep = '\t', header = TRUE)
sample_coord7 <- read.table(file = 'results.7501-8750.ProPC.coord', sep = '\t', header = TRUE)
sample_coord8 <- read.table(file = 'results.8751-10000.ProPC.coord', sep = '\t', header = TRUE)
sample_coord9 <- read.table(file = 'results.10001-11250.ProPC.coord', sep = '\t', header = TRUE)
sample_coord10 <- read.table(file = 'results.11251-12500.ProPC.coord', sep = '\t', header = TRUE)
sample_coord11 <- read.table(file = 'results.12501-13750.ProPC.coord', sep = '\t', header = TRUE)
sample_coord12 <- read.table(file = 'results.13751-15000.ProPC.coord', sep = '\t', header = TRUE)
sample_coord13 <- read.table(file = 'results.15001-16250.ProPC.coord', sep = '\t', header = TRUE)
sample_coord14 <- read.table(file = 'results.16251-17500.ProPC.coord', sep = '\t', header = TRUE)
sample_coord15 <- read.table(file = 'results.17501-18750.ProPC.coord', sep = '\t', header = TRUE)
sample_coord16 <- read.table(file = 'results.18751-20000.ProPC.coord', sep = '\t', header = TRUE)
sample_coord17 <- read.table(file = 'results.20001-21250.ProPC.coord', sep = '\t', header = TRUE)
sample_coord18 <- read.table(file = 'results.21251-21608.ProPC.coord', sep = '\t', header = TRUE)

sample_coord <- rbind(sample_coord1,sample_coord2,sample_coord3,sample_coord4,sample_coord5,sample_coord6,sample_coord7,sample_coord8,sample_coord9,sample_coord10,sample_coord11,sample_coord12,sample_coord13,sample_coord14,sample_coord15,sample_coord16,sample_coord17,sample_coord18)
ORIEN_TCGA_coord <- sample_coord[,c(1,2,7:12)]

#Reference datasets:
HGDP_1000GP <- read.table(file = 'laser.RefPC.coord', sep = '\t', header = TRUE)
HGDP_1000GP <- HGDP_1000GP[,c(2:8)]

#wrote csvs in admixture barplot script
Race <- read.csv("ORIEN_TCGA_IDs_race.csv")
Race <- Race[,c(2,3)]
names(Race)[names(Race) == "WES_ID" ] <- "indivID"
Race2 <- merge(Race,ORIEN_TCGA_coord,by="indivID")
Race2 <- Race2[,c(1,2,4:9)]
names(Race2)[names(Race2) == "pop" ] <- "popID"

Ethnicity <- read.csv("ORIEN_TCGA_IDs_ethnicity.csv")
Ethnicity <- Ethnicity[,c(2,3)]
names(Ethnicity)[names(Ethnicity) == "WES_ID" ] <- "indivID"
Ethnicity2 <- merge(Ethnicity,ORIEN_TCGA_coord,by="indivID")
Ethnicity2 <- Ethnicity2[,c(1,2,4:9)]
names(Ethnicity2)[names(Ethnicity2) == "pop" ] <- "popID"

RefPops <- read.csv("1000GP_HGDP_IDs_Pops.csv")
RefPops <- RefPops[,c(2,3)]
names(RefPops)[names(RefPops) == "WES_ID" ] <- "indivID"
RefPops2 <- merge(RefPops,HGDP_1000GP)
names(RefPops2)[names(RefPops2) == "pop" ] <- "popID"

European <- subset(RefPops2, popID == "European Ancestry")
European_West_Eurasia_SGDP <- subset(RefPops2, popID == "European Ancestry,West Eurasia (SGDP)")
East_Asian <- subset(RefPops2, popID == "East Asian Ancestry")
American <- subset(RefPops2, popID == "American Ancestry")
South_Asian <- subset(RefPops2, popID == "South Asian Ancestry")
African <- subset(RefPops2, popID == "African Ancestry")
South_Asian_SGDP <- subset(RefPops2, popID == "South Asia (SGDP),South Asian Ancestry")
African_SGDP <- subset(RefPops2, popID == "African Ancestry,Africa (SGDP)")
East_Asian_SGDP <- subset(RefPops2, popID == "East Asia (SGDP),East Asian Ancestry")
Central_South_Asia <- subset(RefPops2, popID == "Central South Asia (HGDP)")
Africa_HGDP <- subset(RefPops2, popID == "Africa (HGDP)")
Oceania_HGDP_SGDP <- subset(RefPops2, popID == "Oceania (SGDP),Oceania (HGDP)")
Middle_East_HGDP <- subset(RefPops2, popID == "Middle East (HGDP)")
Europe_HGDP <- subset(RefPops2, popID == "Europe (HGDP)")
East_Asian_HGDP <- subset(RefPops2, popID == "East Asia (HGDP)")
Oceania_HGDP <- subset(RefPops2, popID == "Oceania (HGDP)")
America_HGDP <- subset(RefPops2, popID == "America (HGDP)")
Central_Asia_and_Siberia_SGDP <- subset(RefPops2, popID == "Central Asia and Siberia (SGDP)")
East_Asian_SGDP2 <- subset(RefPops2, popID == "East Asia (SGDP)")
Middle_East_HGDP_Africa_SGDP <- subset(RefPops2, popID == "Middle East (HGDP),Africa (SGDP)")
West_Eurasia <- subset(RefPops2, popID == "West Eurasia (SGDP)")
African_SGDP2 <- subset(RefPops2, popID == "Africa (SGDP)")
Oceania_SGDP <- subset(RefPops2, popID == "Oceania (SGDP)")
America_SGDP <- subset(RefPops2, popID == "America (SGDP)")
South_Asia_SGDP2 <- subset(RefPops2, popID == "South Asia (SGDP),Central South Asia (HGDP)")
South_Asia_SGDP_Central_South_Asia_HGDP <- subset(RefPops2, popID == "South Asia (SGDP),Central South Asia (HGDP)")
America_SGDP_HGDP <- subset(RefPops2, popID == "America (SGDP),America (HGDP)")
East_Asian_SGDP_HGDP <- subset(RefPops2, popID == "East Asia (SGDP),East Asia (HGDP)")
African_SGDP_HGDP <- subset(RefPops2, popID == "Africa (SGDP),Africa (HGDP)")

EUR <- rbind.fill(European, European_West_Eurasia_SGDP, Europe_HGDP)
AFR <- rbind.fill(Africa_HGDP, African, African_SGDP, African_SGDP_HGDP, African_SGDP2)
AMR <- rbind.fill(America_HGDP, America_SGDP, America_SGDP_HGDP, American)
SAS <- rbind.fill(South_Asian, South_Asian_SGDP, Central_South_Asia, South_Asia_SGDP2, South_Asia_SGDP_Central_South_Asia_HGDP)
EAS <- rbind.fill(East_Asian, East_Asian_HGDP, East_Asian_SGDP, East_Asian_SGDP2, East_Asian_SGDP_HGDP)
OCE <- rbind.fill(Oceania_HGDP, Oceania_HGDP_SGDP, Oceania_SGDP)
MDE <- rbind.fill(Middle_East_HGDP, Middle_East_HGDP_Africa_SGDP)

EUR$popID = paste("EUR")
AFR$popID = paste("AFR")
AMR$popID = paste("AMR")
EAS$popID = paste("EAS")
SAS$popID = paste("SAS")

Race2[Race2$popID == "Unknown",]$popID = "Unknown/Not_Reported"
Ethnicity2[Ethnicity2$popID == "Unknown",]$popID = "Unknown/Not_Reported"

HL <- subset(Ethnicity2, popID == "Hispanic/Latino")
NHL <- subset(Ethnicity2, popID == "Not_Hispanic/Not_Latino")
EthNR <- subset(Ethnicity2, popID == "Unknown/Not_Reported")

AfAm <- subset(Race2, popID == "Black_or_African_American")
NAm <- subset(Race2, popID == "American_Indian_or_Alaska_Native")
Asia <- subset(Race2, popID == "Asian")
W <- subset(Race2, popID == "White")
PacIsl <- subset(Race2, popID == "Hawaiian_or_Other_Pacific_Islander")
RaNR <- subset(Race2, popID == "Unknown/Not_Reported")
OthRace <- subset(Race2, popID == "Other")

TCGA_names <- read.table("TCGA_vcfIDs_race_uniq_final.tsv")
names(TCGA_names)[names(TCGA_names ) == "V1" ] <- "indivID"
ORIEN <- anti_join(ORIEN_TCGA_coord, TCGA_names, by="indivID")
ORIEN_HL <- merge(ORIEN, HL, by="indivID")
TCGA_HL <- merge(TCGA_names, HL)
TCGA_HL <- TCGA_HL[,c(1,3:9)]
ORIEN_NHL <- merge(ORIEN, NHL, by="indivID")
TCGA_NHL <- merge(TCGA_names, NHL)
TCGA_NHL <- TCGA_NHL[,c(1,3:9)]
ORIEN_EthNR <- merge(ORIEN, EthNR, by="indivID")
TCGA_EthNR <- merge(TCGA_names, EthNR)
TCGA_EthNR <- TCGA_EthNR[,c(1,3:9)]
ORIEN_AfAm <- merge(ORIEN, AfAm, by="indivID")
TCGA_AfAm <- merge(TCGA_names, AfAm)
TCGA_AfAm <- TCGA_AfAm[,c(1,3:9)]
ORIEN_NAm <- merge(ORIEN, NAm, by="indivID")
TCGA_NAm <- merge(TCGA_names, NAm)
TCGA_NAm <- TCGA_NAm[,c(1,3:9)]
ORIEN_Asia <- merge(ORIEN, Asia, by="indivID")
TCGA_Asia <- merge(TCGA_names, Asia)
TCGA_Asia <- TCGA_Asia[,c(1,3:9)]
ORIEN_W <- merge(ORIEN, W, by="indivID")
TCGA_W <- merge(TCGA_names, W)
TCGA_W <- TCGA_W[,c(1,3:9)]
ORIEN_PacIsl <- merge(ORIEN, PacIsl, by="indivID")
TCGA_PacIsl <- merge(TCGA_names, PacIsl)
TCGA_PacIsl <- TCGA_PacIsl[,c(1,3:9)]
ORIEN_RaNR <- merge(ORIEN, RaNR, by="indivID")
TCGA_RaNR <- merge(TCGA_names, RaNR)
TCGA_RaNR <- TCGA_RaNR[,c(1,3:9)]
ORIEN_OthRace <- merge(ORIEN, OthRace, by="indivID")
TCGA_OthRace <- merge(TCGA_names, OthRace)
TCGA_OthRace <- TCGA_OthRace[,c(1,3:9)]
```

#-------------------
TSNE
```{r}

X <- rbind(AFR,AMR,EUR,SAS,EAS)
#tsvs from igsr website
hgdp <- read.table("igsr-human genome diversity project.tsv.tsv", sep = "\t", header = TRUE)
hgdp <- hgdp[,c(1,5)]
gp1000 <- read.table("igsr-1000 genomes 30x on grch38.tsv.tsv", sep = "\t", header = TRUE)
gp1000 <- gp1000[,c(1,5)]
popnames <- rbind (hgdp,gp1000)
names(popnames)[names(popnames) == "Sample.name" ] <- "indivID"
Xpops <- merge(X, popnames, by="indivID")
Xpops2 <- Xpops[,c(1,9,3:8)]
names(Xpops2)[names(Xpops2) == "Population.name" ] <- "popID"
data_tsne <- Xpops2
## Rtsne function may take some minutes to complete...
set.seed(9)  
## Set dimension
D=2 #or 3
tsne_model_1 = Rtsne(as.matrix(data_tsne[,c(3:8)]), check_duplicates=FALSE, pca=TRUE, perplexity=30, theta=0.5, dims=D)
## getting the two dimension matrix
d_tsne_1 = as.data.frame(tsne_model_1$Y)  

#set K
K=8
plot_cluster=function(data, var_cluster, palette)  
{
  ggplot(data, aes_string(x="V1", y="V2", color=var_cluster)) +
  geom_point(size=0.25) +
  guides(colour=guide_legend(override.aes=list(size=6))) +
  xlab("") + ylab("") +
  ggtitle("") +
  theme_light(base_size=20) +
  theme(axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        legend.direction = "horizontal", 
        legend.position = "bottom",
        legend.box = "horizontal") + 
#  scale_color_viridis(discrete = TRUE, option = "D")+
#  scale_fill_viridis(discrete = TRUE)
    scale_color_brewer(palette = "Dark2")
    }

## keeping original data
d_tsne_1_original=d_tsne_1

## Creating k-means clustering model, and assigning the result to the data used to create the tsne
fit_cluster_kmeans=kmeans(scale(d_tsne_1), K)  
d_tsne_1_original$cl_kmeans = factor(fit_cluster_kmeans$cluster)

## Creating hierarchical cluster model, and assigning the result to the data used to create the tsne
fit_cluster_hierarchical=hclust(dist(scale(d_tsne_1)))

## setting 5 clusters as output
d_tsne_1_original$cl_hierarchical = factor(cutree(fit_cluster_hierarchical, k=K))  

plot_cluster=function(data, var_cluster, palette)  
{
  ggplot(data, aes_string(x="V1", y="V2", color=var_cluster)) +
  ggrepel::geom_text_repel( aes( label = data_tsne$popID), max.overlaps = 100, size = 2, segment.size = 0.1) +
  geom_point(size=0.05) +
  guides(colour=guide_legend(override.aes=list(size=6))) +
  xlab("") + ylab("") +
  ggtitle("") +
  theme_light(base_size=20) +
  theme(axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        legend.direction = "vertical", 
        legend.text=element_text(size=10),
        legend.position = "none", #can make right etc.
       legend.box = "vertical") + 
#  scale_color_viridis(discrete = TRUE, option = "D")+
#  scale_fill_viridis(discrete = TRUE)
    scale_color_brewer(palette = "Dark2")
    }

plot_k=plot_cluster(d_tsne_1_original, "cl_kmeans", "Accent")  
plot_h=plot_cluster(d_tsne_1_original, "cl_hierarchical", "Set1")

## and finally: putting the plots side by side with gridExtra lib...
plot_kmeans <- grid.arrange(plot_k, ncol=1)  
plot_hierarchical <- grid.arrange(plot_h, ncol=1)  
#grid.arrange(plot_k, plot_h,  ncol=2)  


jpeg(file = "HGDP_1000GP_tsne_plot_kmeans.jpeg", width=10, height=5, units="in", res=1000)
plot_k
dev.off()

jpeg(file = "HGDP_1000GP_tsne_plot_hierarchicalclustering.jpeg", width=10, height=5, units="in", res=1000)
plot_h
dev.off()

```

#-------------------
PCA

PC1 vs. PC2 - ORIEN/TCGA Labels = Ethnicity
```{r}

#EUR 
PC1_EUR <- EUR$PC1
PC2_EUR <- EUR$PC2
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC1_EUR, 
    y = PC2_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC1_AFR <- AFR$PC1
PC2_AFR <- AFR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_AFR, 
    y = PC2_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC1_AMR <- AMR$PC1
PC2_AMR <- AMR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_AMR, 
    y = PC2_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC1_OCE <- OCE$PC1
PC2_OCE <- OCE$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_OCE, 
    y = PC2_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC1_MDE <- MDE$PC1
PC2_MDE <- MDE$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_MDE, 
    y = PC2_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC1_EAS <- EAS$PC1
PC2_EAS <- EAS$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_EAS, 
    y = PC2_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC1_SAS <- SAS$PC1
PC2_SAS <- SAS$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_SAS, 
    y = PC2_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
#PC1_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC1
#PC2_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC2

#PCA <- PCA %>%
#  add_markers(
#    x = PC1_Central_Asia_Siberia, 
#    y = PC2_Central_Asia_Siberia, 
#    marker = list(
#      color = 'coral1',
#      size = 10,
#      opacity = 0.3,
#      line = list(
#        color = '#7f7f7f',
#        width = 2
#      )), name = 'Central_Asia_Siberia')

#West_Eurasia
#PC1_West_Eurasia <- West_Eurasia$PC1
#PC2_West_Eurasia <- West_Eurasia$PC2

#PCA <- PCA %>%
#  add_markers(
#    x = PC1_West_Eurasia, 
#    y = PC2_West_Eurasia, 
#    marker = list(
#      color = 'royalblue',
#      size = 10,
#      opacity = 0.3,
#      line = list(
#        color = '#7f7f7f',
#        width = 2
#      )), name = 'West_Eurasia')

#------
#ORIEN Hispanic/Latinx
PC1_ORIEN_HL <- ORIEN_HL$PC1
PC2_ORIEN_HL <- ORIEN_HL$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_HL, 
    y = PC2_ORIEN_HL, 
    marker = list(
      color = 'dodgerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hispanic/Latinx')

#ORIEN NOT Hispanic/Latinx
PC1_ORIEN_NHL <- ORIEN_NHL$PC1
PC2_ORIEN_NHL <- ORIEN_NHL$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_NHL, 
    y = PC2_ORIEN_NHL, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: NOT Hispanic/Latinx')

#ORIEN Unknown Ethnicity
PC1_ORIEN_EthNR <- ORIEN_EthNR$PC1
PC2_ORIEN_EthNR <- ORIEN_EthNR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_EthNR, 
    y = PC2_ORIEN_EthNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Unknown Ethnicity')

#TCGA_HL
PC1_TCGA_HL <- TCGA_HL$PC1
PC2_TCGA_HL <- TCGA_HL$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_HL, 
    y = PC2_TCGA_HL, 
    marker = list(
      color = 'cornflowerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hispanic/Latinx')

#TCGA NOT Hispanic/Latinx
PC1_TCGA_NHL <- TCGA_NHL$PC1
PC2_TCGA_NHL <- TCGA_NHL$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_NHL, 
    y = PC2_TCGA_NHL, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: NOT Hispanic/Latinx')

#TCGA Unknown Ethnicity
PC1_TCGA_EthNR <- TCGA_EthNR$PC1
PC2_TCGA_EthNR <- TCGA_EthNR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_EthNR, 
    y = PC2_TCGA_EthNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Unknown Ethnicity')

x <- list(
  title = "PC1")
y <- list(
  title = "PC2")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_ethnicity_PC1v2.html")

#OTHER COLORS
#crimson
#cornflowerblue
#dodgerblue
#deepskyblue
#coral1
#blueviolet
#darkorchid1
#royalblue
```

PC2 vs. PC3 - ORIEN/TCGA Labels = Ethnicity
```{r}

#EUR 
PC2_EUR <- EUR$PC2
PC3_EUR <- EUR$PC3
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC2_EUR, 
    y = PC3_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC2_AFR <- AFR$PC2
PC3_AFR <- AFR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_AFR, 
    y = PC3_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC2_AMR <- AMR$PC2
PC3_AMR <- AMR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_AMR, 
    y = PC3_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC2_OCE <- OCE$PC2
PC3_OCE <- OCE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_OCE, 
    y = PC3_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC2_MDE <- MDE$PC2
PC3_MDE <- MDE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_MDE, 
    y = PC3_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC2_EAS <- EAS$PC2
PC3_EAS <- EAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_EAS, 
    y = PC3_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC2_SAS <- SAS$PC2
PC3_SAS <- SAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_SAS, 
    y = PC3_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC2_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC2
PC3_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_Central_Asia_Siberia, 
    y = PC3_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC2_West_Eurasia <- West_Eurasia$PC2
PC3_West_Eurasia <- West_Eurasia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_West_Eurasia, 
    y = PC3_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------
#ORIEN Hispanic/Latinx
PC2_ORIEN_HL <- ORIEN_HL$PC2
PC3_ORIEN_HL <- ORIEN_HL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_HL, 
    y = PC3_ORIEN_HL, 
    marker = list(
      color = 'dodgerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hispanic/Latinx')

#ORIEN NOT Hispanic/Latinx
PC2_ORIEN_NHL <- ORIEN_NHL$PC2
PC3_ORIEN_NHL <- ORIEN_NHL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_NHL, 
    y = PC3_ORIEN_NHL, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: NOT Hispanic/Latinx')

#ORIEN Unknown Ethnicity
PC2_ORIEN_EthNR <- ORIEN_EthNR$PC2
PC3_ORIEN_EthNR <- ORIEN_EthNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_EthNR, 
    y = PC3_ORIEN_EthNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Unknown Ethnicity')

#TCGA_HL
PC2_TCGA_HL <- TCGA_HL$PC2
PC3_TCGA_HL <- TCGA_HL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_HL, 
    y = PC3_TCGA_HL, 
    marker = list(
      color = 'cornflowerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hispanic/Latinx')

#TCGA NOT Hispanic/Latinx
PC2_TCGA_NHL <- TCGA_NHL$PC2
PC3_TCGA_NHL <- TCGA_NHL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_NHL, 
    y = PC3_TCGA_NHL, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: NOT Hispanic/Latinx')

#TCGA Unknown Ethnicity
PC2_TCGA_EthNR <- TCGA_EthNR$PC2
PC3_TCGA_EthNR <- TCGA_EthNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_EthNR, 
    y = PC3_TCGA_EthNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Unknown Ethnicity')

x <- list(
  title = "PC2")
y <- list(
  title = "PC3")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_ethnicity_PC2v3.html")

#OTHER COLORS
#crimson
#cornflowerblue
#dodgerblue
#deepskyblue
#coral1
#blueviolet
#darkorchid1
#royalblue
```

PC3 vs. PC4 - ORIEN/TCGA Labels = Ethnicity
```{r}

#EUR 
PC3_EUR <- EUR$PC3
PC4_EUR <- EUR$PC4
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC3_EUR, 
    y = PC4_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC3_AFR <- AFR$PC3
PC4_AFR <- AFR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_AFR, 
    y = PC4_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC3_AMR <- AMR$PC3
PC4_AMR <- AMR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_AMR, 
    y = PC4_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC3_OCE <- OCE$PC3
PC4_OCE <- OCE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_OCE, 
    y = PC4_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC3_MDE <- MDE$PC3
PC4_MDE <- MDE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_MDE, 
    y = PC4_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC3_EAS <- EAS$PC3
PC4_EAS <- EAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_EAS, 
    y = PC4_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC3_SAS <- SAS$PC3
PC4_SAS <- SAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_SAS, 
    y = PC4_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC3_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC3
PC4_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_Central_Asia_Siberia, 
    y = PC4_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC3_West_Eurasia <- West_Eurasia$PC3
PC4_West_Eurasia <- West_Eurasia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_West_Eurasia, 
    y = PC4_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------
#ORIEN Hispanic/Latinx
PC3_ORIEN_HL <- ORIEN_HL$PC3
PC4_ORIEN_HL <- ORIEN_HL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_HL, 
    y = PC4_ORIEN_HL, 
    marker = list(
      color = 'dodgerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hispanic/Latinx')

#ORIEN NOT Hispanic/Latinx
PC3_ORIEN_NHL <- ORIEN_NHL$PC3
PC4_ORIEN_NHL <- ORIEN_NHL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_NHL, 
    y = PC4_ORIEN_NHL, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: NOT Hispanic/Latinx')

#ORIEN Unknown Ethnicity
PC3_ORIEN_EthNR <- ORIEN_EthNR$PC3
PC4_ORIEN_EthNR <- ORIEN_EthNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_EthNR, 
    y = PC4_ORIEN_EthNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Unknown Ethnicity')

#TCGA_HL
PC3_TCGA_HL <- TCGA_HL$PC3
PC4_TCGA_HL <- TCGA_HL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_HL, 
    y = PC4_TCGA_HL, 
    marker = list(
      color = 'cornflowerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hispanic/Latinx')

#TCGA NOT Hispanic/Latinx
PC3_TCGA_NHL <- TCGA_NHL$PC3
PC4_TCGA_NHL <- TCGA_NHL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_NHL, 
    y = PC4_TCGA_NHL, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: NOT Hispanic/Latinx')

#TCGA Unknown Ethnicity
PC3_TCGA_EthNR <- TCGA_EthNR$PC3
PC4_TCGA_EthNR <- TCGA_EthNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_EthNR, 
    y = PC4_TCGA_EthNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Unknown Ethnicity')

x <- list(
  title = "PC3")
y <- list(
  title = "PC4")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_ethnicity_PC3v4.html")

#OTHER COLORS
#crimson
#cornflowerblue
#dodgerblue
#deepskyblue
#coral1
#blueviolet
#darkorchid1
#royalblue
```

PC1 vs. PC3 - ORIEN/TCGA Labels = Ethnicity
```{r}

#EUR 
PC1_EUR <- EUR$PC1
PC3_EUR <- EUR$PC3
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC1_EUR, 
    y = PC3_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC1_AFR <- AFR$PC1
PC3_AFR <- AFR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_AFR, 
    y = PC3_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC1_AMR <- AMR$PC1
PC3_AMR <- AMR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_AMR, 
    y = PC3_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC1_OCE <- OCE$PC1
PC3_OCE <- OCE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_OCE, 
    y = PC3_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC1_MDE <- MDE$PC1
PC3_MDE <- MDE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_MDE, 
    y = PC3_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC1_EAS <- EAS$PC1
PC3_EAS <- EAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_EAS, 
    y = PC3_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC1_SAS <- SAS$PC1
PC3_SAS <- SAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_SAS, 
    y = PC3_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC1_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC1
PC3_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_Central_Asia_Siberia, 
    y = PC3_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC1_West_Eurasia <- West_Eurasia$PC1
PC3_West_Eurasia <- West_Eurasia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_West_Eurasia, 
    y = PC3_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------
#ORIEN Hispanic/Latinx
PC1_ORIEN_HL <- ORIEN_HL$PC1
PC3_ORIEN_HL <- ORIEN_HL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_HL, 
    y = PC3_ORIEN_HL, 
    marker = list(
      color = 'dodgerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hispanic/Latinx')

#ORIEN NOT Hispanic/Latinx
PC1_ORIEN_NHL <- ORIEN_NHL$PC1
PC3_ORIEN_NHL <- ORIEN_NHL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_NHL, 
    y = PC3_ORIEN_NHL, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: NOT Hispanic/Latinx')

#ORIEN Unknown Ethnicity
PC1_ORIEN_EthNR <- ORIEN_EthNR$PC1
PC3_ORIEN_EthNR <- ORIEN_EthNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_EthNR, 
    y = PC3_ORIEN_EthNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Unknown Ethnicity')

#TCGA_HL
PC1_TCGA_HL <- TCGA_HL$PC1
PC3_TCGA_HL <- TCGA_HL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_HL, 
    y = PC3_TCGA_HL, 
    marker = list(
      color = 'cornflowerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hispanic/Latinx')

#TCGA NOT Hispanic/Latinx
PC1_TCGA_NHL <- TCGA_NHL$PC1
PC3_TCGA_NHL <- TCGA_NHL$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_NHL, 
    y = PC3_TCGA_NHL, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: NOT Hispanic/Latinx')

#TCGA Unknown Ethnicity
PC1_TCGA_EthNR <- TCGA_EthNR$PC1
PC3_TCGA_EthNR <- TCGA_EthNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_EthNR, 
    y = PC3_TCGA_EthNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Unknown Ethnicity')

x <- list(
  title = "PC1")
y <- list(
  title = "PC3")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_ethnicity_PC1v3.html")

#OTHER COLORS
#crimson
#cornflowerblue
#dodgerblue
#deepskyblue
#coral1
#blueviolet
#darkorchid1
#royalblue
```

PC1 vs. PC4 - ORIEN/TCGA Labels = Ethnicity
```{r}

#EUR 
PC1_EUR <- EUR$PC1
PC4_EUR <- EUR$PC4
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC1_EUR, 
    y = PC4_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC1_AFR <- AFR$PC1
PC4_AFR <- AFR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_AFR, 
    y = PC4_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC1_AMR <- AMR$PC1
PC4_AMR <- AMR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_AMR, 
    y = PC4_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC1_OCE <- OCE$PC1
PC4_OCE <- OCE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_OCE, 
    y = PC4_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC1_MDE <- MDE$PC1
PC4_MDE <- MDE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_MDE, 
    y = PC4_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC1_EAS <- EAS$PC1
PC4_EAS <- EAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_EAS, 
    y = PC4_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC1_SAS <- SAS$PC1
PC4_SAS <- SAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_SAS, 
    y = PC4_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC1_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC1
PC4_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_Central_Asia_Siberia, 
    y = PC4_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC1_West_Eurasia <- West_Eurasia$PC1
PC4_West_Eurasia <- West_Eurasia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_West_Eurasia, 
    y = PC4_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------
#ORIEN Hispanic/Latinx
PC1_ORIEN_HL <- ORIEN_HL$PC1
PC4_ORIEN_HL <- ORIEN_HL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_HL, 
    y = PC4_ORIEN_HL, 
    marker = list(
      color = 'dodgerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hispanic/Latinx')

#ORIEN NOT Hispanic/Latinx
PC1_ORIEN_NHL <- ORIEN_NHL$PC1
PC4_ORIEN_NHL <- ORIEN_NHL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_NHL, 
    y = PC4_ORIEN_NHL, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: NOT Hispanic/Latinx')

#ORIEN Unknown Ethnicity
PC1_ORIEN_EthNR <- ORIEN_EthNR$PC1
PC4_ORIEN_EthNR <- ORIEN_EthNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_EthNR, 
    y = PC4_ORIEN_EthNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Unknown Ethnicity')

#TCGA_HL
PC1_TCGA_HL <- TCGA_HL$PC1
PC4_TCGA_HL <- TCGA_HL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_HL, 
    y = PC4_TCGA_HL, 
    marker = list(
      color = 'cornflowerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hispanic/Latinx')

#TCGA NOT Hispanic/Latinx
PC1_TCGA_NHL <- TCGA_NHL$PC1
PC4_TCGA_NHL <- TCGA_NHL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_NHL, 
    y = PC4_TCGA_NHL, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: NOT Hispanic/Latinx')

#TCGA Unknown Ethnicity
PC1_TCGA_EthNR <- TCGA_EthNR$PC1
PC4_TCGA_EthNR <- TCGA_EthNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_EthNR, 
    y = PC4_TCGA_EthNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Unknown Ethnicity')

x <- list(
  title = "PC1")
y <- list(
  title = "PC4")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_ethnicity_PC1v4.html")

#OTHER COLORS
#crimson
#cornflowerblue
#dodgerblue
#deepskyblue
#coral1
#blueviolet
#darkorchid1
#royalblue
```

PC2 vs. PC4 - ORIEN/TCGA Labels = Ethnicity
```{r}

#EUR 
PC2_EUR <- EUR$PC2
PC4_EUR <- EUR$PC4
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC2_EUR, 
    y = PC4_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC2_AFR <- AFR$PC2
PC4_AFR <- AFR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_AFR, 
    y = PC4_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC2_AMR <- AMR$PC2
PC4_AMR <- AMR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_AMR, 
    y = PC4_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC2_OCE <- OCE$PC2
PC4_OCE <- OCE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_OCE, 
    y = PC4_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC2_MDE <- MDE$PC2
PC4_MDE <- MDE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_MDE, 
    y = PC4_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC2_EAS <- EAS$PC2
PC4_EAS <- EAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_EAS, 
    y = PC4_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC2_SAS <- SAS$PC2
PC4_SAS <- SAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_SAS, 
    y = PC4_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC2_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC2
PC4_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_Central_Asia_Siberia, 
    y = PC4_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC2_West_Eurasia <- West_Eurasia$PC2
PC4_West_Eurasia <- West_Eurasia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_West_Eurasia, 
    y = PC4_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------
#ORIEN Hispanic/Latinx
PC2_ORIEN_HL <- ORIEN_HL$PC2
PC4_ORIEN_HL <- ORIEN_HL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_HL, 
    y = PC4_ORIEN_HL, 
    marker = list(
      color = 'dodgerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hispanic/Latinx')

#ORIEN NOT Hispanic/Latinx
PC2_ORIEN_NHL <- ORIEN_NHL$PC2
PC4_ORIEN_NHL <- ORIEN_NHL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_NHL, 
    y = PC4_ORIEN_NHL, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: NOT Hispanic/Latinx')

#ORIEN Unknown Ethnicity
PC2_ORIEN_EthNR <- ORIEN_EthNR$PC2
PC4_ORIEN_EthNR <- ORIEN_EthNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_EthNR, 
    y = PC4_ORIEN_EthNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Unknown Ethnicity')

#TCGA_HL
PC2_TCGA_HL <- TCGA_HL$PC2
PC4_TCGA_HL <- TCGA_HL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_HL, 
    y = PC4_TCGA_HL, 
    marker = list(
      color = 'cornflowerblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hispanic/Latinx')

#TCGA NOT Hispanic/Latinx
PC2_TCGA_NHL <- TCGA_NHL$PC2
PC4_TCGA_NHL <- TCGA_NHL$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_NHL, 
    y = PC4_TCGA_NHL, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: NOT Hispanic/Latinx')

#TCGA Unknown Ethnicity
PC2_TCGA_EthNR <- TCGA_EthNR$PC2
PC4_TCGA_EthNR <- TCGA_EthNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_EthNR, 
    y = PC4_TCGA_EthNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Unknown Ethnicity')

x <- list(
  title = "PC2")
y <- list(
  title = "PC4")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_ethnicity_PC2v4.html")

#OTHER COLORS
#crimson
#cornflowerblue
#dodgerblue
#deepskyblue
#coral1
#blueviolet
#darkorchid1
#royalblue
```

#-------------------
PCA

PC1 vs. PC2 - ORIEN/TCGA Labels = Race
```{r}

#EUR 
PC1_EUR <- EUR$PC1
PC2_EUR <- EUR$PC2
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC1_EUR, 
    y = PC2_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC1_AFR <- AFR$PC1
PC2_AFR <- AFR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_AFR, 
    y = PC2_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC1_AMR <- AMR$PC1
PC2_AMR <- AMR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_AMR, 
    y = PC2_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC1_OCE <- OCE$PC1
PC2_OCE <- OCE$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_OCE, 
    y = PC2_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC1_MDE <- MDE$PC1
PC2_MDE <- MDE$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_MDE, 
    y = PC2_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC1_EAS <- EAS$PC1
PC2_EAS <- EAS$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_EAS, 
    y = PC2_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC1_SAS <- SAS$PC1
PC2_SAS <- SAS$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_SAS, 
    y = PC2_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC1_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC1
PC2_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_Central_Asia_Siberia, 
    y = PC2_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC1_West_Eurasia <- West_Eurasia$PC1
PC2_West_Eurasia <- West_Eurasia$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_West_Eurasia, 
    y = PC2_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------


#ORIEN American Indian Alaska Native
PC1_ORIEN_NAm <- ORIEN_NAm$PC1
PC2_ORIEN_NAm <- ORIEN_NAm$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_NAm, 
    y = PC2_ORIEN_NAm, 
    marker = list(
      color = 'salmon',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: American Indian or Alaska Native')

#ORIEN Asian
PC1_ORIEN_Asia <- ORIEN_Asia$PC1
PC2_ORIEN_Asia <- ORIEN_Asia$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_Asia, 
    y = PC2_ORIEN_Asia, 
    marker = list(
      color = 'forestgreen',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Asian')

#ORIEN African American/Black
PC1_ORIEN_AfAm <- ORIEN_AfAm$PC1
PC2_ORIEN_AfAm <- ORIEN_AfAm$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_AfAm, 
    y = PC2_ORIEN_AfAm, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Black or African American')

#ORIEN Hawaiian or Other Pacific Islander
PC1_ORIEN_PacIsl <- ORIEN_PacIsl$PC1
PC2_ORIEN_PacIsl <- ORIEN_PacIsl$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_PacIsl, 
    y = PC2_ORIEN_PacIsl, 
    marker = list(
      color = 'darkblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hawaiian or Other Pacific Islander')

#ORIEN Not Reported/Unknown
PC1_ORIEN_RaNR <- ORIEN_RaNR$PC1
PC2_ORIEN_RaNR <- ORIEN_RaNR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_RaNR, 
    y = PC2_ORIEN_RaNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Race Unknown/Not Reported')

#ORIEN White
PC1_ORIEN_W <- ORIEN_W$PC1
PC2_ORIEN_W <- ORIEN_W$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_W, 
    y = PC2_ORIEN_W, 
    marker = list(
      color = 'darkred',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: White')

#ORIEN Other Race
PC1_ORIEN_OthRace <- ORIEN_OthRace$PC1
PC2_ORIEN_OthRace <- ORIEN_OthRace$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_OthRace, 
    y = PC2_ORIEN_OthRace, 
    marker = list(
      color = 'midnightblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Other Race')

#TCGA American Indian Alaska Native
PC1_TCGA_NAm <- TCGA_NAm$PC1
PC2_TCGA_NAm <- TCGA_NAm$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_NAm, 
    y = PC2_TCGA_NAm, 
    marker = list(
      color = 'lightpink',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: American Indian or Alaska Native')

#TCGA Asian
PC1_TCGA_Asia <- TCGA_Asia$PC1
PC2_TCGA_Asia <- TCGA_Asia$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_Asia, 
    y = PC2_TCGA_Asia, 
    marker = list(
      color = 'seagreen1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Asian')

#TCGA African American/Black
PC1_TCGA_AfAm <- TCGA_AfAm$PC1
PC2_TCGA_AfAm <- TCGA_AfAm$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_AfAm, 
    y = PC2_TCGA_AfAm, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Black or African American')

#TCGA Hawaiian or Other Pacific Islander
PC1_TCGA_PacIsl <- TCGA_PacIsl$PC1
PC2_TCGA_PacIsl <- TCGA_PacIsl$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_PacIsl, 
    y = PC2_TCGA_PacIsl, 
    marker = list(
      color = 'blueviolet',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hawaiian or Other Pacific Islander')

#TCGA Not Reported/Unknown
PC1_TCGA_RaNR <- TCGA_RaNR$PC1
PC2_TCGA_RaNR <- TCGA_RaNR$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_RaNR, 
    y = PC2_TCGA_RaNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Race Unknown/Not Reported')

#TCGA White
PC1_TCGA_W <- TCGA_W$PC1
PC2_TCGA_W <- TCGA_W$PC2

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_W, 
    y = PC2_TCGA_W, 
    marker = list(
      color = 'crimson',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: White')


x <- list(
  title = "PC1")
y <- list(
  title = "PC2")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_race_PC1v2.html")

#OTHER COLORS
  #deepskyblue
  #royalblue
```

PC2 vs. PC3 - ORIEN/TCGA Labels = Race
```{r}

#EUR 
PC2_EUR <- EUR$PC2
PC3_EUR <- EUR$PC3
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC2_EUR, 
    y = PC3_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC2_AFR <- AFR$PC2
PC3_AFR <- AFR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_AFR, 
    y = PC3_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC2_AMR <- AMR$PC2
PC3_AMR <- AMR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_AMR, 
    y = PC3_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC2_OCE <- OCE$PC2
PC3_OCE <- OCE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_OCE, 
    y = PC3_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC2_MDE <- MDE$PC2
PC3_MDE <- MDE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_MDE, 
    y = PC3_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC2_EAS <- EAS$PC2
PC3_EAS <- EAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_EAS, 
    y = PC3_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC2_SAS <- SAS$PC2
PC3_SAS <- SAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_SAS, 
    y = PC3_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC2_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC2
PC3_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_Central_Asia_Siberia, 
    y = PC3_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC2_West_Eurasia <- West_Eurasia$PC2
PC3_West_Eurasia <- West_Eurasia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_West_Eurasia, 
    y = PC3_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------


#ORIEN American Indian Alaska Native
PC2_ORIEN_NAm <- ORIEN_NAm$PC2
PC3_ORIEN_NAm <- ORIEN_NAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_NAm, 
    y = PC3_ORIEN_NAm, 
    marker = list(
      color = 'salmon',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: American Indian or Alaska Native')

#ORIEN Asian
PC2_ORIEN_Asia <- ORIEN_Asia$PC2
PC3_ORIEN_Asia <- ORIEN_Asia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_Asia, 
    y = PC3_ORIEN_Asia, 
    marker = list(
      color = 'forestgreen',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Asian')

#ORIEN African American/Black
PC2_ORIEN_AfAm <- ORIEN_AfAm$PC2
PC3_ORIEN_AfAm <- ORIEN_AfAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_AfAm, 
    y = PC3_ORIEN_AfAm, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Black or African American')

#ORIEN Hawaiian or Other Pacific Islander
PC2_ORIEN_PacIsl <- ORIEN_PacIsl$PC2
PC3_ORIEN_PacIsl <- ORIEN_PacIsl$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_PacIsl, 
    y = PC3_ORIEN_PacIsl, 
    marker = list(
      color = 'darkblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hawaiian or Other Pacific Islander')

#ORIEN Not Reported/Unknown
PC2_ORIEN_RaNR <- ORIEN_RaNR$PC2
PC3_ORIEN_RaNR <- ORIEN_RaNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_RaNR, 
    y = PC3_ORIEN_RaNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Race Unknown/Not Reported')

#ORIEN White
PC2_ORIEN_W <- ORIEN_W$PC2
PC3_ORIEN_W <- ORIEN_W$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_W, 
    y = PC3_ORIEN_W, 
    marker = list(
      color = 'darkred',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: White')

#ORIEN Other Race
PC2_ORIEN_OthRace <- ORIEN_OthRace$PC2
PC3_ORIEN_OthRace <- ORIEN_OthRace$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_OthRace, 
    y = PC3_ORIEN_OthRace, 
    marker = list(
      color = 'midnightblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Other Race')

#TCGA American Indian Alaska Native
PC2_TCGA_NAm <- TCGA_NAm$PC2
PC3_TCGA_NAm <- TCGA_NAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_NAm, 
    y = PC3_TCGA_NAm, 
    marker = list(
      color = 'lightpink',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: American Indian or Alaska Native')

#TCGA Asian
PC2_TCGA_Asia <- TCGA_Asia$PC2
PC3_TCGA_Asia <- TCGA_Asia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_Asia, 
    y = PC3_TCGA_Asia, 
    marker = list(
      color = 'seagreen1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Asian')

#TCGA African American/Black
PC2_TCGA_AfAm <- TCGA_AfAm$PC2
PC3_TCGA_AfAm <- TCGA_AfAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_AfAm, 
    y = PC3_TCGA_AfAm, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Black or African American')

#TCGA Hawaiian or Other Pacific Islander
PC2_TCGA_PacIsl <- TCGA_PacIsl$PC2
PC3_TCGA_PacIsl <- TCGA_PacIsl$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_PacIsl, 
    y = PC3_TCGA_PacIsl, 
    marker = list(
      color = 'blueviolet',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hawaiian or Other Pacific Islander')

#TCGA Not Reported/Unknown
PC2_TCGA_RaNR <- TCGA_RaNR$PC2
PC3_TCGA_RaNR <- TCGA_RaNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_RaNR, 
    y = PC3_TCGA_RaNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Race Unknown/Not Reported')

#TCGA White
PC2_TCGA_W <- TCGA_W$PC2
PC3_TCGA_W <- TCGA_W$PC3

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_W, 
    y = PC3_TCGA_W, 
    marker = list(
      color = 'crimson',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: White')


x <- list(
  title = "PC2")
y <- list(
  title = "PC3")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_race_PC2v3.html")

#OTHER COLORS
  #deepskyblue
  #royalblue
```

PC3 vs. PC4 - ORIEN/TCGA Labels = Race
```{r}

#EUR 
PC3_EUR <- EUR$PC3
PC4_EUR <- EUR$PC4
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC3_EUR, 
    y = PC4_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC3_AFR <- AFR$PC3
PC4_AFR <- AFR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_AFR, 
    y = PC4_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC3_AMR <- AMR$PC3
PC4_AMR <- AMR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_AMR, 
    y = PC4_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC3_OCE <- OCE$PC3
PC4_OCE <- OCE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_OCE, 
    y = PC4_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC3_MDE <- MDE$PC3
PC4_MDE <- MDE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_MDE, 
    y = PC4_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC3_EAS <- EAS$PC3
PC4_EAS <- EAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_EAS, 
    y = PC4_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC3_SAS <- SAS$PC3
PC4_SAS <- SAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_SAS, 
    y = PC4_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC3_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC3
PC4_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_Central_Asia_Siberia, 
    y = PC4_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC3_West_Eurasia <- West_Eurasia$PC3
PC4_West_Eurasia <- West_Eurasia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_West_Eurasia, 
    y = PC4_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------


#ORIEN American Indian Alaska Native
PC3_ORIEN_NAm <- ORIEN_NAm$PC3
PC4_ORIEN_NAm <- ORIEN_NAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_NAm, 
    y = PC4_ORIEN_NAm, 
    marker = list(
      color = 'salmon',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: American Indian or Alaska Native')

#ORIEN Asian
PC3_ORIEN_Asia <- ORIEN_Asia$PC3
PC4_ORIEN_Asia <- ORIEN_Asia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_Asia, 
    y = PC4_ORIEN_Asia, 
    marker = list(
      color = 'forestgreen',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Asian')

#ORIEN African American/Black
PC3_ORIEN_AfAm <- ORIEN_AfAm$PC3
PC4_ORIEN_AfAm <- ORIEN_AfAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_AfAm, 
    y = PC4_ORIEN_AfAm, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Black or African American')

#ORIEN Hawaiian or Other Pacific Islander
PC3_ORIEN_PacIsl <- ORIEN_PacIsl$PC3
PC4_ORIEN_PacIsl <- ORIEN_PacIsl$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_PacIsl, 
    y = PC4_ORIEN_PacIsl, 
    marker = list(
      color = 'darkblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hawaiian or Other Pacific Islander')

#ORIEN Not Reported/Unknown
PC3_ORIEN_RaNR <- ORIEN_RaNR$PC3
PC4_ORIEN_RaNR <- ORIEN_RaNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_RaNR, 
    y = PC4_ORIEN_RaNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Race Unknown/Not Reported')

#ORIEN White
PC3_ORIEN_W <- ORIEN_W$PC3
PC4_ORIEN_W <- ORIEN_W$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_W, 
    y = PC4_ORIEN_W, 
    marker = list(
      color = 'darkred',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: White')

#ORIEN Other Race
PC3_ORIEN_OthRace <- ORIEN_OthRace$PC3
PC4_ORIEN_OthRace <- ORIEN_OthRace$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_ORIEN_OthRace, 
    y = PC4_ORIEN_OthRace, 
    marker = list(
      color = 'midnightblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Other Race')

#TCGA American Indian Alaska Native
PC3_TCGA_NAm <- TCGA_NAm$PC3
PC4_TCGA_NAm <- TCGA_NAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_NAm, 
    y = PC4_TCGA_NAm, 
    marker = list(
      color = 'lightpink',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: American Indian or Alaska Native')

#TCGA Asian
PC3_TCGA_Asia <- TCGA_Asia$PC3
PC4_TCGA_Asia <- TCGA_Asia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_Asia, 
    y = PC4_TCGA_Asia, 
    marker = list(
      color = 'seagreen1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Asian')

#TCGA African American/Black
PC3_TCGA_AfAm <- TCGA_AfAm$PC3
PC4_TCGA_AfAm <- TCGA_AfAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_AfAm, 
    y = PC4_TCGA_AfAm, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Black or African American')

#TCGA Hawaiian or Other Pacific Islander
PC3_TCGA_PacIsl <- TCGA_PacIsl$PC3
PC4_TCGA_PacIsl <- TCGA_PacIsl$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_PacIsl, 
    y = PC4_TCGA_PacIsl, 
    marker = list(
      color = 'blueviolet',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hawaiian or Other Pacific Islander')

#TCGA Not Reported/Unknown
PC3_TCGA_RaNR <- TCGA_RaNR$PC3
PC4_TCGA_RaNR <- TCGA_RaNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_RaNR, 
    y = PC4_TCGA_RaNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Race Unknown/Not Reported')

#TCGA White
PC3_TCGA_W <- TCGA_W$PC3
PC4_TCGA_W <- TCGA_W$PC4

PCA <- PCA %>%
  add_markers(
    x = PC3_TCGA_W, 
    y = PC4_TCGA_W, 
    marker = list(
      color = 'crimson',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: White')


x <- list(
  title = "PC3")
y <- list(
  title = "PC4")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_race_PC3v4.html")

#OTHER COLORS
  #deepskyblue
  #royalblue
```

PC1 vs. PC3 - ORIEN/TCGA Labels = Race
```{r}

#EUR 
PC1_EUR <- EUR$PC1
PC3_EUR <- EUR$PC3
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC1_EUR, 
    y = PC3_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC1_AFR <- AFR$PC1
PC3_AFR <- AFR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_AFR, 
    y = PC3_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC1_AMR <- AMR$PC1
PC3_AMR <- AMR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_AMR, 
    y = PC3_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC1_OCE <- OCE$PC1
PC3_OCE <- OCE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_OCE, 
    y = PC3_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC1_MDE <- MDE$PC1
PC3_MDE <- MDE$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_MDE, 
    y = PC3_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC1_EAS <- EAS$PC1
PC3_EAS <- EAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_EAS, 
    y = PC3_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC1_SAS <- SAS$PC1
PC3_SAS <- SAS$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_SAS, 
    y = PC3_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC1_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC1
PC3_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_Central_Asia_Siberia, 
    y = PC3_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC1_West_Eurasia <- West_Eurasia$PC1
PC3_West_Eurasia <- West_Eurasia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_West_Eurasia, 
    y = PC3_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------


#ORIEN American Indian Alaska Native
PC1_ORIEN_NAm <- ORIEN_NAm$PC1
PC3_ORIEN_NAm <- ORIEN_NAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_NAm, 
    y = PC3_ORIEN_NAm, 
    marker = list(
      color = 'salmon',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: American Indian or Alaska Native')

#ORIEN Asian
PC1_ORIEN_Asia <- ORIEN_Asia$PC1
PC3_ORIEN_Asia <- ORIEN_Asia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_Asia, 
    y = PC3_ORIEN_Asia, 
    marker = list(
      color = 'forestgreen',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Asian')

#ORIEN African American/Black
PC1_ORIEN_AfAm <- ORIEN_AfAm$PC1
PC3_ORIEN_AfAm <- ORIEN_AfAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_AfAm, 
    y = PC3_ORIEN_AfAm, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Black or African American')

#ORIEN Hawaiian or Other Pacific Islander
PC1_ORIEN_PacIsl <- ORIEN_PacIsl$PC1
PC3_ORIEN_PacIsl <- ORIEN_PacIsl$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_PacIsl, 
    y = PC3_ORIEN_PacIsl, 
    marker = list(
      color = 'darkblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hawaiian or Other Pacific Islander')

#ORIEN Not Reported/Unknown
PC1_ORIEN_RaNR <- ORIEN_RaNR$PC1
PC3_ORIEN_RaNR <- ORIEN_RaNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_RaNR, 
    y = PC3_ORIEN_RaNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Race Unknown/Not Reported')

#ORIEN White
PC1_ORIEN_W <- ORIEN_W$PC1
PC3_ORIEN_W <- ORIEN_W$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_W, 
    y = PC3_ORIEN_W, 
    marker = list(
      color = 'darkred',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: White')

#ORIEN Other Race
PC1_ORIEN_OthRace <- ORIEN_OthRace$PC1
PC3_ORIEN_OthRace <- ORIEN_OthRace$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_OthRace, 
    y = PC3_ORIEN_OthRace, 
    marker = list(
      color = 'midnightblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Other Race')

#TCGA American Indian Alaska Native
PC1_TCGA_NAm <- TCGA_NAm$PC1
PC3_TCGA_NAm <- TCGA_NAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_NAm, 
    y = PC3_TCGA_NAm, 
    marker = list(
      color = 'lightpink',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: American Indian or Alaska Native')

#TCGA Asian
PC1_TCGA_Asia <- TCGA_Asia$PC1
PC3_TCGA_Asia <- TCGA_Asia$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_Asia, 
    y = PC3_TCGA_Asia, 
    marker = list(
      color = 'seagreen1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Asian')

#TCGA African American/Black
PC1_TCGA_AfAm <- TCGA_AfAm$PC1
PC3_TCGA_AfAm <- TCGA_AfAm$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_AfAm, 
    y = PC3_TCGA_AfAm, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Black or African American')

#TCGA Hawaiian or Other Pacific Islander
PC1_TCGA_PacIsl <- TCGA_PacIsl$PC1
PC3_TCGA_PacIsl <- TCGA_PacIsl$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_PacIsl, 
    y = PC3_TCGA_PacIsl, 
    marker = list(
      color = 'blueviolet',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hawaiian or Other Pacific Islander')

#TCGA Not Reported/Unknown
PC1_TCGA_RaNR <- TCGA_RaNR$PC1
PC3_TCGA_RaNR <- TCGA_RaNR$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_RaNR, 
    y = PC3_TCGA_RaNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Race Unknown/Not Reported')

#TCGA White
PC1_TCGA_W <- TCGA_W$PC1
PC3_TCGA_W <- TCGA_W$PC3

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_W, 
    y = PC3_TCGA_W, 
    marker = list(
      color = 'crimson',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: White')


x <- list(
  title = "PC1")
y <- list(
  title = "PC3")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_race_PC1v3.html")

#OTHER COLORS
  #deepskyblue
  #royalblue
```

PC1 vs. PC4 - ORIEN/TCGA Labels = Race
```{r}

#EUR 
PC1_EUR <- EUR$PC1
PC4_EUR <- EUR$PC4
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC1_EUR, 
    y = PC4_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC1_AFR <- AFR$PC1
PC4_AFR <- AFR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_AFR, 
    y = PC4_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC1_AMR <- AMR$PC1
PC4_AMR <- AMR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_AMR, 
    y = PC4_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC1_OCE <- OCE$PC1
PC4_OCE <- OCE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_OCE, 
    y = PC4_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC1_MDE <- MDE$PC1
PC4_MDE <- MDE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_MDE, 
    y = PC4_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC1_EAS <- EAS$PC1
PC4_EAS <- EAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_EAS, 
    y = PC4_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC1_SAS <- SAS$PC1
PC4_SAS <- SAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_SAS, 
    y = PC4_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC1_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC1
PC4_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_Central_Asia_Siberia, 
    y = PC4_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC1_West_Eurasia <- West_Eurasia$PC1
PC4_West_Eurasia <- West_Eurasia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_West_Eurasia, 
    y = PC4_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------


#ORIEN American Indian Alaska Native
PC1_ORIEN_NAm <- ORIEN_NAm$PC1
PC4_ORIEN_NAm <- ORIEN_NAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_NAm, 
    y = PC4_ORIEN_NAm, 
    marker = list(
      color = 'salmon',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: American Indian or Alaska Native')

#ORIEN Asian
PC1_ORIEN_Asia <- ORIEN_Asia$PC1
PC4_ORIEN_Asia <- ORIEN_Asia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_Asia, 
    y = PC4_ORIEN_Asia, 
    marker = list(
      color = 'forestgreen',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Asian')

#ORIEN African American/Black
PC1_ORIEN_AfAm <- ORIEN_AfAm$PC1
PC4_ORIEN_AfAm <- ORIEN_AfAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_AfAm, 
    y = PC4_ORIEN_AfAm, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Black or African American')

#ORIEN Hawaiian or Other Pacific Islander
PC1_ORIEN_PacIsl <- ORIEN_PacIsl$PC1
PC4_ORIEN_PacIsl <- ORIEN_PacIsl$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_PacIsl, 
    y = PC4_ORIEN_PacIsl, 
    marker = list(
      color = 'darkblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hawaiian or Other Pacific Islander')

#ORIEN Not Reported/Unknown
PC1_ORIEN_RaNR <- ORIEN_RaNR$PC1
PC4_ORIEN_RaNR <- ORIEN_RaNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_RaNR, 
    y = PC4_ORIEN_RaNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Race Unknown/Not Reported')

#ORIEN White
PC1_ORIEN_W <- ORIEN_W$PC1
PC4_ORIEN_W <- ORIEN_W$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_W, 
    y = PC4_ORIEN_W, 
    marker = list(
      color = 'darkred',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: White')

#ORIEN Other Race
PC1_ORIEN_OthRace <- ORIEN_OthRace$PC1
PC4_ORIEN_OthRace <- ORIEN_OthRace$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_ORIEN_OthRace, 
    y = PC4_ORIEN_OthRace, 
    marker = list(
      color = 'midnightblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Other Race')

#TCGA American Indian Alaska Native
PC1_TCGA_NAm <- TCGA_NAm$PC1
PC4_TCGA_NAm <- TCGA_NAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_NAm, 
    y = PC4_TCGA_NAm, 
    marker = list(
      color = 'lightpink',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: American Indian or Alaska Native')

#TCGA Asian
PC1_TCGA_Asia <- TCGA_Asia$PC1
PC4_TCGA_Asia <- TCGA_Asia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_Asia, 
    y = PC4_TCGA_Asia, 
    marker = list(
      color = 'seagreen1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Asian')

#TCGA African American/Black
PC1_TCGA_AfAm <- TCGA_AfAm$PC1
PC4_TCGA_AfAm <- TCGA_AfAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_AfAm, 
    y = PC4_TCGA_AfAm, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Black or African American')

#TCGA Hawaiian or Other Pacific Islander
PC1_TCGA_PacIsl <- TCGA_PacIsl$PC1
PC4_TCGA_PacIsl <- TCGA_PacIsl$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_PacIsl, 
    y = PC4_TCGA_PacIsl, 
    marker = list(
      color = 'blueviolet',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hawaiian or Other Pacific Islander')

#TCGA Not Reported/Unknown
PC1_TCGA_RaNR <- TCGA_RaNR$PC1
PC4_TCGA_RaNR <- TCGA_RaNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_RaNR, 
    y = PC4_TCGA_RaNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Race Unknown/Not Reported')

#TCGA White
PC1_TCGA_W <- TCGA_W$PC1
PC4_TCGA_W <- TCGA_W$PC4

PCA <- PCA %>%
  add_markers(
    x = PC1_TCGA_W, 
    y = PC4_TCGA_W, 
    marker = list(
      color = 'crimson',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: White')


x <- list(
  title = "PC1")
y <- list(
  title = "PC4")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_race_PC1v4.html")

#OTHER COLORS
  #deepskyblue
  #royalblue
```

PC2 vs. PC4 - ORIEN/TCGA Labels = Race
```{r}

#EUR 
PC2_EUR <- EUR$PC2
PC4_EUR <- EUR$PC4
PCA <- plot_ly(data = references, type = 'scatter', mode = "markers")
PCA <- PCA %>%
  add_markers(
    x = PC2_EUR, 
    y = PC4_EUR, 
    marker = list(
      color = 'darkgreen',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EUR')


#AFR
PC2_AFR <- AFR$PC2
PC4_AFR <- AFR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_AFR, 
    y = PC4_AFR, 
    marker = list(
      color = 'firebrick',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AFR')


#AMR
PC2_AMR <- AMR$PC2
PC4_AMR <- AMR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_AMR, 
    y = PC4_AMR, 
    marker = list(
      color = 'gold',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'AMR')


#OCE
PC2_OCE <- OCE$PC2
PC4_OCE <- OCE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_OCE, 
    y = PC4_OCE, 
    marker = list(
      color = 'blue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'OCE')


#MDE
PC2_MDE <- MDE$PC2
PC4_MDE <- MDE$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_MDE, 
    y = PC4_MDE, 
    marker = list(
      color = 'purple',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'MDE')


#EAS
PC2_EAS <- EAS$PC2
PC4_EAS <- EAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_EAS, 
    y = PC4_EAS, 
    marker = list(
      color = 'chartreuse',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'EAS')


#SAS
PC2_SAS <- SAS$PC2
PC4_SAS <- SAS$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_SAS, 
    y = PC4_SAS, 
    marker = list(
      color = 'deeppink',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'SAS')

#Central_Asia_Siberia
PC2_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC2
PC4_Central_Asia_Siberia <- Central_Asia_and_Siberia_SGDP$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_Central_Asia_Siberia, 
    y = PC4_Central_Asia_Siberia, 
    marker = list(
      color = 'coral1',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'Central_Asia_Siberia')

#West_Eurasia
PC2_West_Eurasia <- West_Eurasia$PC2
PC4_West_Eurasia <- West_Eurasia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_West_Eurasia, 
    y = PC4_West_Eurasia, 
    marker = list(
      color = 'royalblue',
      size = 10,
      opacity = 0.3,
      line = list(
        color = '#7f7f7f',
        width = 2
      )), name = 'West_Eurasia')

#------


#ORIEN American Indian Alaska Native
PC2_ORIEN_NAm <- ORIEN_NAm$PC2
PC4_ORIEN_NAm <- ORIEN_NAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_NAm, 
    y = PC4_ORIEN_NAm, 
    marker = list(
      color = 'salmon',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: American Indian or Alaska Native')

#ORIEN Asian
PC2_ORIEN_Asia <- ORIEN_Asia$PC2
PC4_ORIEN_Asia <- ORIEN_Asia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_Asia, 
    y = PC4_ORIEN_Asia, 
    marker = list(
      color = 'forestgreen',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Asian')

#ORIEN African American/Black
PC2_ORIEN_AfAm <- ORIEN_AfAm$PC2
PC4_ORIEN_AfAm <- ORIEN_AfAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_AfAm, 
    y = PC4_ORIEN_AfAm, 
    marker = list(
      color = 'darkorchid',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Black or African American')

#ORIEN Hawaiian or Other Pacific Islander
PC2_ORIEN_PacIsl <- ORIEN_PacIsl$PC2
PC4_ORIEN_PacIsl <- ORIEN_PacIsl$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_PacIsl, 
    y = PC4_ORIEN_PacIsl, 
    marker = list(
      color = 'darkblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Hawaiian or Other Pacific Islander')

#ORIEN Not Reported/Unknown
PC2_ORIEN_RaNR <- ORIEN_RaNR$PC2
PC4_ORIEN_RaNR <- ORIEN_RaNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_RaNR, 
    y = PC4_ORIEN_RaNR, 
    marker = list(
      color = 'gray80',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Race Unknown/Not Reported')

#ORIEN White
PC2_ORIEN_W <- ORIEN_W$PC2
PC4_ORIEN_W <- ORIEN_W$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_W, 
    y = PC4_ORIEN_W, 
    marker = list(
      color = 'darkred',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: White')

#ORIEN Other Race
PC2_ORIEN_OthRace <- ORIEN_OthRace$PC2
PC4_ORIEN_OthRace <- ORIEN_OthRace$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_ORIEN_OthRace, 
    y = PC4_ORIEN_OthRace, 
    marker = list(
      color = 'midnightblue',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'ORIEN: Other Race')

#TCGA American Indian Alaska Native
PC2_TCGA_NAm <- TCGA_NAm$PC2
PC4_TCGA_NAm <- TCGA_NAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_NAm, 
    y = PC4_TCGA_NAm, 
    marker = list(
      color = 'lightpink',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: American Indian or Alaska Native')

#TCGA Asian
PC2_TCGA_Asia <- TCGA_Asia$PC2
PC4_TCGA_Asia <- TCGA_Asia$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_Asia, 
    y = PC4_TCGA_Asia, 
    marker = list(
      color = 'seagreen1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Asian')

#TCGA African American/Black
PC2_TCGA_AfAm <- TCGA_AfAm$PC2
PC4_TCGA_AfAm <- TCGA_AfAm$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_AfAm, 
    y = PC4_TCGA_AfAm, 
    marker = list(
      color = 'darkorchid1',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Black or African American')

#TCGA Hawaiian or Other Pacific Islander
PC2_TCGA_PacIsl <- TCGA_PacIsl$PC2
PC4_TCGA_PacIsl <- TCGA_PacIsl$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_PacIsl, 
    y = PC4_TCGA_PacIsl, 
    marker = list(
      color = 'blueviolet',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Hawaiian or Other Pacific Islander')

#TCGA Not Reported/Unknown
PC2_TCGA_RaNR <- TCGA_RaNR$PC2
PC4_TCGA_RaNR <- TCGA_RaNR$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_RaNR, 
    y = PC4_TCGA_RaNR, 
    marker = list(
      color = 'gray48',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: Race Unknown/Not Reported')

#TCGA White
PC2_TCGA_W <- TCGA_W$PC2
PC4_TCGA_W <- TCGA_W$PC4

PCA <- PCA %>%
  add_markers(
    x = PC2_TCGA_W, 
    y = PC4_TCGA_W, 
    marker = list(
      color = 'crimson',
      size = 10,
      opacity = 0.7,
      line = list(
        color = 'black',
        width = 2
      )), name = 'TCGA: White')


x <- list(
  title = "PC2")
y <- list(
  title = "PC4")


PCA <- PCA %>% layout(xaxis = x, yaxis = y)
PCA

htmlwidgets::saveWidget(as_widget(PCA), "PCA_race_PC2v4.html")

#OTHER COLORS
  #deepskyblue
  #royalblue
```
